<apex:page lightningStylesheets="true" controller="ApproveBelowRatesRecordsController" sidebar="false" showHeader="false"> 
    <apex:slds />
    <script>
    function getRecordId(myId,status) {
        if(status == 'Approve') {
            callUpdateApprove(myId);    
        }
        else {
            callUpdateReject(myId);
        }
        return false;
    }
    </script>
    <apex:form >
        <apex:actionfunction name="callUpdateApprove" action="{!approveSingleRecord}" reRender="content">
            <apex:param name="pricingId1" value="" />
        </apex:actionfunction>
        <apex:actionfunction name="callUpdateReject" action="{!rejectSingleRecord}" reRender="content">
            <apex:param name="pricingId2" value="" />
        </apex:actionfunction>
        
        <apex:outputText value="No Records Found for Approve/Reject" rendered="{!IF(listBelowRackRatesRecords.size > 0,false,true)}" style="color:red;text-align:center;"/>
        <apex:outputPanel id="content">
            <apex:pageBlock rendered="{!IF(listBelowRackRatesRecords.size > 0,true,false)}">
                <apex:pageBlockSection title="Below Rack Rate Records" collapsible="false" columns="1">
                    <apex:pageBlockTable value="{!listBelowRackRatesRecords}" var="record">
                        <apex:column headerValue="Payment Mode" value="{!record.Payment_Mode_Text__c}"/>
                        <apex:column headerValue="Payment Option" value="{!record.Payment_Option_Text__c}"/>
                        <apex:column headerValue="Specification" value="{!record.Specifcation__c}"/>
                        <apex:column headerValue="Payment Gateway" value="{!record.Payment_Gateway_Text__c}"/>
                        <apex:column headerValue="TDR REFERENCE">
                            <apex:outputField value="{!record.TDR_Amount_Reference__c}"/>|  
                            <apex:outputField value="{!record.TDR_Percentage_Reference__c}"/>
                        </apex:column>
                        <apex:column headerValue="TDR RATE">
                            <apex:outputField value="{!record.TDR_Amount__c}"/>|
                            <apex:outputField value="{!record.TDR_Flat_Fee__c}"/>|  
                            <apex:outputField value="{!record.TDR__c}"/>
                        </apex:column>
                        <apex:column headerValue="CONVENIENCE REFERENCE">
                            <apex:outputField value="{!record.Convenience_Amount_Reference__c}"/>|  
                            <apex:outputField value="{!record.Convenience_Percentage_Reference__c}"/>
                        </apex:column>
                        <apex:column headerValue="CONVENIENCE RATE">
                            <apex:outputField value="{!record.Convenience_Amount__c}"/>|
                            <apex:outputField value="{!record.Convenience_Flat_Fee__c}"/>|  
                            <apex:outputField value="{!record.Convenience__c}"/>
                        </apex:column>
                        <apex:column headerValue="APPROVE">
                            <apex:commandButton value="Approve" onclick="getRecordId('{!record.Id}','Approve');return false;"/>
                        </apex:column>
                        <apex:column headerValue="REJECT">
                            <apex:commandButton value="Reject" onclick="getRecordId('{!record.Id}','Reject');return false;"/>
                        </apex:column>
                    </apex:pageBlockTable>
                    <apex:pageBlockSectionItem >
                        
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockButtons location="bottom" >
                    <apex:commandButton value="Approve All" action="{!approveAllFunction}"/>
                    <apex:commandButton value="Reject All" action="{!rejectAllFunction}"/>
                </apex:pageBlockButtons>
            </apex:pageBlock>
        </apex:outputPanel>
        
        
        <apex:outputPanel id="content1">
            <apex:pageBlock rendered="{!IF(listAllRecords.size > 0,true,false)}">
                <apex:pageBlockSection title="All records" collapsible="false" columns="1">
                    <apex:pageBlockTable value="{!listAllRecords}" var="record">
                        <apex:column headerValue="Payment Mode" value="{!record.Payment_Mode_Text__c}"/>
                        <apex:column headerValue="Payment Option" value="{!record.Payment_Option_Text__c}"/>
                        <apex:column headerValue="Specification" value="{!record.Specifcation__c}"/>
                        <apex:column headerValue="Payment Gateway" value="{!record.Payment_Gateway_Text__c}"/>
                        <apex:column headerValue="TDR REFERENCE">
                            <apex:outputField value="{!record.TDR_Amount_Reference__c}"/>|  
                            <apex:outputField value="{!record.TDR_Percentage_Reference__c}"/>
                        </apex:column>
                        <apex:column headerValue="TDR RATE">
                            <apex:outputField value="{!record.TDR_Amount__c}"/>|
                            <apex:outputField value="{!record.TDR_Flat_Fee__c}"/>|  
                            <apex:outputField value="{!record.TDR__c}"/>
                        </apex:column>
                        <apex:column headerValue="CONVENIENCE REFERENCE">
                            <apex:outputField value="{!record.Convenience_Amount_Reference__c}"/>|  
                            <apex:outputField value="{!record.Convenience_Percentage_Reference__c}"/>
                        </apex:column>
                        <apex:column headerValue="CONVENIENCE RATE">
                            <apex:outputField value="{!record.Convenience_Amount__c}"/>|
                            <apex:outputField value="{!record.Convenience_Flat_Fee__c}"/>|  
                            <apex:outputField value="{!record.Convenience__c}"/>
                        </apex:column>
                    </apex:pageBlockTable>
                </apex:pageBlockSection>
            </apex:pageBlock>
        </apex:outputPanel>
    </apex:form>
</apex:page>